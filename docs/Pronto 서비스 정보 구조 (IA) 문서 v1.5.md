# Pronto 서비스 정보 구조 (IA) 문서 v1.6 (2025년 5월 11일 업데이트)

*(참고: 본 문서는 **PRD v4.20**을 기준으로 작성되었습니다.)*

**(변경 이력: v1.6 - 2025년 5월 11일, 시간 선택 자동화 기능 추가 (최초 선택 시 1시간 자동 선택, 최소 1시간 남았을 때 전체 취소 기능); v1.5 - 2025년 5월 10일, 시간 선택 UI UX 상세화 (눈금 위치 및 레이블 형식 변경); v1.4 - 2025년 5월 9일, 예약 연장 및 동시 예약 실패 처리 관련 페이지 및 컴포넌트 정보 추가)**

---

## 1. 사이트 맵 (Site Map)

서비스를 구성하는 주요 페이지 목록입니다.

### 사용자 영역 (User Area)

| 페이지 ID    | 설명                             | 경로                     |
| --------- | ------------------------------ | ---------------------- |
| **P‑000** | 회원가입 페이지 (이메일)                 | `/signup`              |
| **P‑001** | 로그인 페이지                        | `/auth/login`          |
| **P‑002** | 서비스 상세 및 예약 페이지                | `/service/{serviceId}` |
| **P‑005** | 마이페이지                          | `/my`                  |
|           | 예약 내역 목록/상세                    | `/my/reservations`     |
|           | 작성한 리뷰 목록 (수정/삭제 포함)           | `/my/reviews`          |
|           | 보유 시간 확인 (적립/쿠폰)               | `/my/time`             |
|           | 계정 설정 (회원 탈퇴 포함)               | `/my/settings`         |
| **P‑006** | 결제 페이지                         | `/payment`             |
| **P‑007** | 결제 완료 페이지                      | `/payment/complete`    |
| **P‑008** | 예약 변경 페이지/모달 (마이페이지 내 작동)*    | —                      |
| **P‑009** | 리뷰 작성/수정 페이지/모달 (마이페이지 내 작동)* | —                      |
| **P‑010** | 비밀번호 찾기 페이지                    | `/password/find`       |
| **P‑011** | 비밀번호 재설정 페이지                   | `/password/reset`      |
| **P‑012** | 예약 연장 페이지/모달 (마이페이지 내 작동 또는 알림톡 링크)* | `/my/reservations/{reservationId}/extend` (예시 경로) |
| **P‑013** | 예약 실패 및 자동 환불 안내 페이지/모달* | — (특정 상황 발생 시 표시)                        |

* 모달로 구현될 경우 경로는 없으며, 해당 기능을 실행하는 페이지 내에서 표시됨

### 운영자 영역 (Admin Area) *(접근 권한 필요)*

| 페이지 ID    | 설명                             | 경로                        |
| --------- | ------------------------------ | ------------------------- |
| **P‑101** | 예약 현황 페이지 (대시보드)               | `/admin/reservations`     |
|           | 예약 목록 조회                       | —                         |
|           | 예약 상세 조회 (변경/취소 기능 포함)         | —                         |
| **P‑102** | 예약 설정 페이지                      | `/admin/settings/booking` |
|           | 휴무일 설정                         | —                         |
|           | *(향후)* 운영 시간 등 규칙 설정           | —                         |
| **P‑103** | 고객 목록 페이지                      | `/admin/customers`        |
|           | 고객 목록 조회 (적립/쿠폰 정보 포함)         | —                         |
|           | 고객 상세 조회 (쿠폰 부여 기능 포함)         | —                         |
| **P‑104** | 고객 추가/수정 페이지/모달 (P‑103 내 작동)* | —                         |
| **P‑105** | 대리 예약 정보 입력/확인 페이지             | `/admin/reservations/new` |
| **P‑106** | 서비스 정보 관리 페이지                  | `/admin/settings/service` |
| **P‑107** | 리뷰 관리 페이지                      | `/admin/reviews`          |

---

## 2. 사용자 플로우 (User Flow)

*(PRD v4.19 기준 주요 플로우 반영)*

### 2‑1. 신규 고객 (이메일) 회원가입 및 첫 예약

1. **P‑001** 이동 ▶ '이메일로 회원가입' 클릭
2. **P‑000** 정보 입력 ▶ '가입하기'
3. 이메일 인증 링크 클릭 ▶ 가입 완료
4. **P‑001** 로그인
5. **P‑002** 이동 ▶ 날짜·시간 선택(최소 1 시간) ▶ '예약하기'
6. 예약 정보 입력 ▶ 사용 가능 시간 확인(없음) ▶ 개인정보 동의 ▶ '예약 완료 및 결제하기'
7. **P‑006** 결제 진행
8. **P‑007** 결과 확인
9. *(백엔드)* 예약 확정 알림톡 수신

### 2‑2. 기존 고객 예약 (적립/쿠폰 사용)

1. **P‑001** 로그인
2. **P‑002** 날짜·시간 선택(예: 2 시간) ▶ '예약하기'
3. 예약 정보 자동 완성 ▶ 보유 시간 확인 ▶ 초과 1 시간에 대해 30 / 60 분 할인 선택 ▶ 개인정보 동의 ▶ '예약 완료 및 결제하기'
4. **P‑006** 할인 금액 결제
5. **P‑007** 결과 확인
6. *(백엔드)* 예약 확정 알림톡+시간 차감

### 2‑3. 예약 변경

1. 로그인 ▶ **P‑005** 마이페이지 ▶ 예약 내역
2. 예약 건 확인 (예약 시작 1 분 전까지 '예약 변경' 버튼 노출)* ▶ 클릭
3. **P‑008** 표시 ▶ 새 날짜·시간 선택 ▶ 실시간 가능 확인 ▶ '변경 완료'
4. 예약 정보 `modified` 업데이트 ▶ 완료 메시지
5. *(백엔드)* 변경 알림톡 발송

### 2‑4. 예약 취소

1. 로그인 ▶ **P‑005** ▶ 예약 내역
2. 예약 건 확인 (시작 31 분 전까지 '예약 취소' 노출)* ▶ 클릭
3. 취소 확인 팝업 ▶ '확인'
4. 예약 `cancelled` + 환불 API 호출 ▶ 완료 메시지
5. *(백엔드)* 취소 알림톡 발송

### 2‑5. 리뷰 작성 및 적립 시간 획득

1. 로그인 ▶ **P‑005** ▶ 예약 내역
2. 완료 예약 ▶ '리뷰 작성'
3. **P‑009** 별점·텍스트(10‑100자)·이미지(≤5) ▶ '리뷰 등록'
4. 리뷰 저장 + 적립 10 분 부여 ▶ 완료 안내
5. *(선택)* 적립 알림톡 발송

### 2‑6. 운영자 쿠폰 부여

1. 운영자 로그인 ▶ **P‑103**
2. 고객 선택 ▶ '쿠폰 부여'
3. 쿠폰 개수(30 분 단위) 선택 ▶ '부여하기'
4. `customer_coupons` 저장 ▶ 완료 메시지

### 2‑7. 운영자 로그인 및 예약 확인

1. **P‑001** ▶ 운영자 계정 로그인
2. 권한 확인 후 **P‑101** 이동 ▶ 예약 목록·상세 확인

### 2-8. 예약 연장

1. 로그인 ▶ **P‑005** ▶ 예약 내역 또는 알림톡 링크 클릭
2. 진행 중인 예약 또는 종료 10분 이내(Grace Period) 예약 ▶ '예약 연장' 클릭
3. **P‑012** 표시 ▶ 연장 시간 선택(30분 단위) ▶ 추가 요금 및 할인 확인
4. '결제 및 연장하기' 클릭 ▶ 결제 진행 (보유 시간 자동 차감 후 잔액)
5. 연장 완료 ▶ 예약 정보 업데이트(`end_time` 수정) ▶ 알림톡 발송

### 2-9. 동시 예약 처리 및 실패 안내

1. 사용자 A, B가 동일 시간대 예약 시도 ▶ 사용자 A가 먼저 결제 완료 및 예약 확정
2. 사용자 B가 결제 완료 ▶ 시스템이 중복 예약 감지 ▶ 자동 환불 처리
3. **P‑013** 표시 ▶ "예약이 확정되지 못했습니다. 결제금액은 자동으로 환불됩니다." 안내
4. *(백엔드)* 환불 및 안내 알림톡 발송

---

## 3. 네비게이션 구조 (Navigation Structure)

### 주 네비게이션 – 상단 바 (Topbar)

* **좌측**: 서비스 로고 ▶ 클릭 시 **P‑002**
* **우측 (비로그인)**: *'로그인'* ▶ **P‑001**
* **우측 (로그인)**: *'마이페이지'* ▶ **P‑005**, *'로그아웃'*

### 마이페이지 내부 네비게이션 *(탭 방식 예시)*

* **예약 내역**  |  **내 리뷰**  |  **보유 시간**  |  **계정 설정**

### 운영자 페이지 내부 네비게이션 *(사이드바 예시)*

* **예약 현황** (P‑101)
* **고객 관리** (P‑103)
* **리뷰 관리** (P‑107)
* **예약 설정** (P‑102)
* **서비스 정보 관리** (P‑106)
* **로그아웃**

### 푸터 네비게이션 *(선택 사항)*

* 서비스 이용 약관, 개인정보 처리 방침 등 링크

---

## 4. 페이지 계층 구조 (Page Hierarchy)

```
- 서비스 (Public)
  ├─ 로그인 P‑001 (/auth/login)
  │   ├─ 회원가입 P‑000
  │   └─ 비밀번호 찾기 P‑010
  │        └─ 비밀번호 재설정 P‑011
  └─ 서비스 상세·예약 P‑002
       └─ 결제 P‑006
            └─ 결제 완료 P‑007

- 마이페이지 (P‑005, 로그인 필요)
  ├─ 예약 내역
  │   ├─ 예약 변경 P‑008
  │   ├─ 예약 취소(확인)
  │   └─ 예약 연장 P‑012 (신규)
  ├─ 작성한 리뷰
  │   ├─ 리뷰 작성/수정 P‑009
  │   └─ 리뷰 삭제(확인)
  ├─ 보유 시간
  └─ 계정 설정
       └─ 회원 탈퇴(확인)

- 운영자 관리 (로그인 필요)
  ├─ 예약 현황 P‑101
  │   ├─ 예약 상세(변경·취소)
  │   └─ 대리 예약 P‑105
  ├─ 예약 설정 P‑102
  ├─ 고객 관리 P‑103
  │   └─ 고객 추가/수정 P‑104
  ├─ 리뷰 관리 P‑107
  └─ 서비스 정보 관리 P‑106
  
- 예약 실패 처리
  └─ 예약 실패 및 자동 환불 안내 P‑013 (결제 후 동시 예약 충돌 시)
```

---

## 5. 콘텐츠 조직화 (Content Organization)

### 서비스 상세 페이지 (P‑002)

#### 핵심 콘텐츠 영역

1. **서비스 정보**
   * 서비스명, 소개 텍스트, 대표 이미지(슬라이더), 가격
   * 위치 정보, 유의사항, 취소 정책

2. **리뷰 섹션**
   * 평균 별점, 리뷰 수
   * 리뷰 목록 (별점, 내용, 이미지, 작성자명(일부 마스킹), 작성일)

3. **예약 섹션**
   * 날짜 선택 (캘린더)
   * 시간 선택 (타임 슬롯 피커)
     * 00:00부터 23:30까지 30분 단위 시간 슬롯을 모두 표시
     * UI 상단에 정각(HH:00)과 30분(HH:30) 시간을 나타내는 눈금과 24시간제 레이블 표시
     * 사용자는 각 슬롯의 활성/비활성 상태를 시각적으로 구분하여 예약 가능 시간 파악
     * 각 슬롯은 눈금 사이의 공간을 차지하며 슬롯 내부에 별도 시간 텍스트 미표시
   * 예약 정보 입력 폼 (이름, 업체명, 촬영 목적, 차량번호, 요청 사항)
   * 할인 적용 영역 (보유 적립/쿠폰 시간, 적용 선택)
   * 최종 금액 및 예약 버튼

### 마이페이지 (P‑005)

* **상단/좌측**: 사용자 요약(닉네임, 보유 적립·쿠폰)
* **메인**: 예약 내역 기본 표시 → 탭으로 내 리뷰·보유 시간·계정 설정 이동

### 운영자 페이지

* **대시보드 (P‑101)** 기본 표시
* **사이드바**로 고객·리뷰·설정 등 분리 접근

---

## 6. 상호작용 패턴 (Interaction Patterns)

### 시간 선택

* **기본 UI**: 24시간(00:00-23:30) 타임라인 상에 30분 단위 슬롯을 모두 표시하며, UI 상단에는 각 슬롯의 시작 경계를 나타내는 눈금과 시간 레이블(정각은 'HH:00', 30분은 'HH:30')이 제공됨
* **선택 방식**: 활성화된 슬롯 중 시작 시간 선택 시 자동으로 1시간(2개 연속 슬롯)이 선택됨. 이후 30분씩 범위 확장 가능. 최소 1시간만 남았을 때 슬롯 클릭 시 전체 선택 취소됨.
* **비활성화 상태**: 운영 시간 외, 다른 예약 있음, 지난 시간 등 이유로 선택 불가한 슬롯은 시각적으로 구분됨
* **선택 정보 표시**: 선택한 시간 범위와 총 시간, 예상 결제 금액을 실시간으로 표시

### 폼 제출

* 필수 입력 검증 후 버튼 활성화, 로딩·피드백 제공

### 정보 확장/숨김

* '예약하기' 클릭 시 하단 폼 확장, 리뷰 '더보기'로 전체 노출

### 모달/팝업

* 예약 변경(P‑008), 리뷰 작성(P‑009), 고객 추가(P‑104), 취소·탈퇴 확인 등

### 탭

* 상세페이지, 마이페이지 등 정보 구조화 표시

### 드롭다운

* 시간 할인(적립/쿠폰) 선택 등 제한 옵션

### 연장 UI

* 예약 연장(P-012)에서 추가 시간 선택, 추가 요금 및 할인 정보 표시, 결제 버튼

### 알림 토스트

* 예약 만료 임박 시 화면 내 알림, 예약 실패 시 명확한 안내 메시지 표시

---

## 7. URL 구조 (URL Structure)

| 경로                                       | 설명               |
| ---------------------------------------- | ---------------- |
| `/auth/login`                            | 로그인 페이지          |
| `/signup`                                | 회원가입 페이지         |
| `/password/find`                         | 비밀번호 찾기          |
| `/password/reset?token={token}`          | 비밀번호 재설정         |
| `/service/{serviceId}`                   | 서비스 상세·예약        |
| `/payment`                               | 결제 페이지           |
| `/payment/complete?success={true/false}` | 결제 완료            |
| `/my`                                    | 마이페이지 (예약 내역 기본) |
| `/my/reviews`                            | 내 리뷰             |
| `/my/time`                               | 보유 시간            |
| `/my/settings`                           | 계정 설정            |
| `/my/reservations/{reservationId}/extend` | 예약 연장 페이지/모달 UI (딥링크 대상) |
| `/admin` (→ P‑101)                       | 운영자 로그인 리디렉션     |
| `/admin/reservations`                    | 예약 현황            |
| `/admin/reservations/new`                | 대리 예약            |
| `/admin/customers`                       | 고객 목록            |
| `/admin/reviews`                         | 리뷰 관리            |
| `/admin/settings/booking`                | 예약 설정            |
| `/admin/settings/service`                | 서비스 정보 관리        |

---

## 8. 컴포넌트 계층 구조 (Component Hierarchy)

### 전역 컴포넌트

* **Header** (로고·네비게이션)
* **Footer** (저작권·사업자 정보)
* **Button** (기본/비활성)
* **Input Field** (텍스트·비밀번호·Textarea)
* **Checkbox**
* **Modal / Popup**

### 기능별 컴포넌트

* **Calendar Picker** (월 이동·날짜 선택)
* **Time Slot Picker** (시간 슬롯 표시/선택. **기본적으로 00:00-23:30의 모든 슬롯을 표시**하며, UI 상단에는 24시간제 정각 눈금('HH:00') 및 30분 눈금('HH:30')이 각 슬롯의 시작 경계에 맞춰 제공됨. 각 30분 슬롯 박스는 두 눈금 사이 공간을 차지하며 내부에 시간 텍스트는 표시하지 않음. API 응답에 따라 서비스 운영 시간 외 슬롯 및 예약 불가 슬롯은 비활성화 처리. 예약 연장 UI에서도 재사용 가능.)
* **Service Info Card**
* **Tab Navigation & Content**
* **Review Card** / **Review List**
* **Booking Form** (예약 정보 입력)
* **Time Discount Selector** (적립/쿠폰 시간 드롭다운)
* **Reservation List Item**
* **Admin Sidebar**
* **Admin Data Table** (목록 테이블)
* **Coupon Grant UI** (운영자용)
* **ReservationExtensionForm** (예약 연장 UI: 연장 시간 선택, 추가 요금 표시, 결제 트리거 컴포넌트)
* **ConcurrencyFailureNotification** (동시 예약 실패 및 자동 환불 안내 메시지 표시 컴포넌트)
* **EndOfBookingReminderToast** (예약 만료 임박 알림 토스트/팝업 컴포넌트)

### Time Slot Picker

* **계층 구조**:
  ```
  TimeSlotPicker
  ├─ TimelineTicks
  │   └─ TimeLabel (HH:00, HH:30 형식)
  ├─ TimeSlots
  │   └─ TimeSlot (슬롯당 30분, 활성/비활성/선택 상태 포함)
  └─ SelectedTimeInfo (선택 시간 정보 표시)
  ```

* **주요 속성**:
  * `date`: 선택된 날짜
  * `operatingHours`: 해당 날짜의 운영 시간
  * `unavailableSlots`: 예약 불가 시간 목록
  * `isClosed`: 휴무일 여부
  * `message`: 휴무 사유 등 메시지
  * `currentTime`: 현재 시간 (오늘 날짜인 경우)
  * `selectedRange`: 사용자가 선택한 시간 범위
  * `onSelectionChange`: 선택 변경 이벤트 핸들러

* **특징**:
  * 눈금이 각 슬롯의 시작 경계에 맞춰 제공됨 (정각은 굵은 눈금, 30분은 얇은 눈금)
  * 눈금 위에는 'HH:00' 또는 'HH:30' 형식의 24시간제 레이블 표시
  * 각 30분 슬롯 박스는 두 눈금 사이 공간을 차지하며 내부에 시간 텍스트는 표시하지 않음
  * 최초 시간 선택 시 자동으로 1시간(2개 슬롯) 선택됨
  * 선택된 슬롯이 2개(1시간)일 때 그 중 하나를 클릭하면 전체 선택이 취소됨
  * 연속적이지 않은 시간을 선택할 경우 새로운 선택 지점부터 1시간 자동 선택
  * 다양한 상태 (가능/불가/선택됨)를 시각적으로 구분
  * 키보드 접근성, 모바일 터치 인터랙션 지원

---

> 위 IA 문서는 **PRD v4.19**을 기반으로 작성되었으며 실제 구현 시 디자인·기술 제약에 따라 일부 조정될 수 있습니다. 반응형 디자인, SEO 최적화, 웹 접근성(WCAG 2.1 AA)·시맨틱 HTML·ARIA 속성 등을 반드시 고려하십시오.

*end of document*
