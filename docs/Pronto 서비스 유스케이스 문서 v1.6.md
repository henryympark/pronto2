# Pronto 서비스 유스케이스 문서 v1.7 (2025년 5월 11일 업데이트)

*(참고: 본 문서는 PRD v4.20을 기준으로 작성되었습니다.)*
**(변경 이력: v1.7 - 2025년 5월 11일, 시간 선택 자동화 기능 추가 (최초 선택 시 1시간 자동 선택, 최소 1시간 남았을 때 전체 취소 기능); v1.6 - 2025년 5월 10일, 시간 선택 UI UX 상세화 (눈금 위치 및 레이블 형식 변경); v1.5 - 2025년 5월 9일, 예약 연장 및 동시간대 예약 처리 유스케이스 추가/보강)**

---

## 1. 액터 정의 (Actor Definitions)

* **고객 (Customer)**: 서비스를 예약하고 이용하는 최종 사용자입니다. 회원가입, 로그인, 서비스 탐색, 예약, 결제, 예약 변경/취소, 리뷰 작성, 보유 시간(적립/쿠폰) 확인/사용 등의 기능을 수행합니다.
* **운영자 (Operator)**: 서비스(Pronto)를 관리하고 운영하는 주체입니다. 관리자 계정으로 로그인하여 예약 현황 관리, 고객 관리(쿠폰 부여 포함), 리뷰 관리, 서비스 정보 및 예약 설정 관리, 대리 예약 등의 기능을 수행합니다. (현재 1인 운영 기준, 'admin' 역할)
* **시스템 (System)**: Pronto 서비스 백엔드 및 프론트엔드 시스템 전체를 의미합니다. 사용자의 요청을 처리하고, 데이터를 관리하며, 외부 시스템(카카오, 네이버, PortOne 등)과 연동합니다.

---

## 2. 유스케이스 시나리오 (Use Case Scenarios)

서비스의 주요 기능별 사용 사례 목록입니다.

### 인증 관련

* **UC‑01**: 고객 이메일 회원가입 및 로그인
* **UC‑02**: 고객 소셜(카카오/네이버) 로그인
* **UC‑03**: 고객 비밀번호 찾기 및 재설정
* **UC‑04**: 고객 로그아웃
* **UC‑05**: 고객 회원 탈퇴
* **UC‑06**: 운영자 이메일 로그인

### 예약 및 결제 관련

* **UC‑07**: 고객 서비스 상세 정보 및 리뷰 조회
* **UC‑08**: 고객 예약 신청 (날짜/시간 선택, 정보 입력, 적립/쿠폰 시간 사용)
* **UC‑09**: 고객 결제 진행
* **UC‑10**: 고객 예약 변경
* **UC‑11**: 고객 예약 취소

### 리뷰 및 적립/쿠폰 시간 관련

* **UC‑12**: 고객 리뷰 작성 및 적립 시간 획득
* **UC‑13**: 고객 리뷰 수정
* **UC‑14**: 고객 리뷰 삭제
* **UC‑15**: 고객 보유 적립/쿠폰 시간 확인

### 운영자 관련

* **UC‑16**: 운영자 예약 현황 조회 및 상세 확인
* **UC‑17**: 운영자 고객 예약 변경
* **UC‑18**: 운영자 고객 예약 취소 (환불 처리 포함)
* **UC‑19**: 운영자 고객 목록 및 정보 조회 (적립/쿠폰 시간 포함)

  * **UC‑19‑1**: 운영자 고객 쿠폰 부여
* **UC‑20**: 운영자 리뷰 목록 조회 및 관리 (숨김/삭제)
* **UC‑21**: 운영자 서비스 정보 관리
* **UC‑22**: 운영자 예약 설정 관리 (휴무일 등)
* **UC‑23**: 운영자 대리 예약 생성 및 결제 요청

---

## 3. 상세 유스케이스 시나리오 (Detailed Use Case Scenarios)

주요 유스케이스에 대한 상세 설명입니다.

### UC‑01: 고객 이메일 회원가입 및 로그인

| 구분               | 내용                                                                                                                                                                 |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **액터**           | 고객                                                                                                                                                                 |
| **개요**           | 고객이 이메일 주소를 이용하여 서비스에 회원가입하고 로그인합니다.                                                                                                                               |
| **사전 조건**        | 고객이 서비스의 로그인 페이지(P‑001)에 접근한 상태입니다.                                                                                                                                |
| **사후 조건 (성공 시)** | - 고객 정보가 customers 테이블에 저장됩니다 (비밀번호는 해싱됨, is\_active는 이메일 인증 후 true).<br>- 고객은 이메일 인증 후 로그인할 수 있습니다.<br>- 로그인 성공 시 고객은 서비스의 기본 페이지(P‑002) 또는 이전에 접근하려던 페이지로 이동합니다. |
| **비즈니스 규칙 및 제약** | - 이메일, 이름, 비밀번호, 휴대폰 번호는 필수 입력 항목입니다.<br>- 비밀번호는 8자 이상, 영문/숫자/특수문자 조합 규칙을 따릅니다.<br>- 이미 가입된 이메일 또는 휴대폰 번호로는 가입할 수 없습니다.<br>- 이메일 인증을 완료해야 계정이 활성화됩니다.              |

#### 주요 성공 시나리오 (Main Steps and Flow of Events)

1. 고객이 로그인 페이지(P‑001)에서 '이메일로 회원가입' 링크를 클릭합니다.
2. 시스템은 회원가입 페이지(P‑000)를 표시합니다.
3. 고객은 이메일, 비밀번호, 비밀번호 확인, 이름, 휴대폰 번호를 입력하고 '가입하기' 버튼을 클릭합니다.
4. 시스템은 입력 정보의 유효성을 검사합니다 (형식, 중복 등).
5. (유효성 통과 시) 시스템은 고객 정보를 임시 저장하고, 입력된 이메일 주소로 인증 메일을 발송합니다.
6. 시스템은 고객에게 이메일 인증 안내 메시지를 표시합니다.
7. 고객은 수신한 이메일에서 인증 링크를 클릭합니다.
8. 시스템은 인증 링크의 유효성을 확인하고, 해당 고객 계정의 is\_active 상태를 true로 변경합니다.
9. 시스템은 인증 완료 페이지 또는 로그인 페이지(P‑001)를 표시합니다.
10. 고객은 로그인 페이지(P‑001)에서 가입한 이메일과 비밀번호를 입력하고 '로그인' 버튼을 클릭합니다.
11. 시스템은 입력된 정보와 저장된 고객 정보를 비교하여 인증을 수행합니다.
12. (인증 성공 시) 시스템은 로그인 세션을 생성하고 고객을 해당 페이지로 리디렉션합니다.

#### 대체 흐름 및 예외 처리 (Alternative Flows and Edge Cases / Exception Handling Procedures)

* **4a. 입력 정보 유효성 검사 실패**: 시스템은 오류가 발생한 입력 필드와 오류 내용을 명확하게 표시하고 가입 절차를 중단합니다.
* **5a. 이미 가입된 이메일/휴대폰**: 시스템은 "이미 가입된 이메일 주소입니다." 또는 "이미 등록된 휴대폰 번호입니다." 메시지를 표시합니다.
* **7a. 이메일 미수신**: 고객은 재발송 요청 기능을 사용할 수 있습니다 (기능 추가 필요).
* **8a. 인증 링크 만료 또는 무효**: 시스템은 "유효하지 않거나 만료된 인증 링크입니다." 메시지를 표시하고, 필요한 경우 인증 메일 재발송을 안내합니다.
* **11a. 로그인 정보 불일치**: 시스템은 "이메일 또는 비밀번호가 올바르지 않습니다." 메시지를 표시합니다.
* **11b. 계정 비활성화 상태**: 시스템은 "이메일 인증이 필요하거나 비활성화된 계정입니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항 (User Interface Considerations)

* 회원가입 폼(P‑000)과 로그인 폼(P‑001)은 명확한 레이블과 플레이스홀더를 제공합니다.
* 비밀번호 입력 필드는 마스킹 처리되며, '비밀번호 보기' 옵션을 제공할 수 있습니다.
* 오류 메시지는 해당 필드 근처 또는 폼 상/하단에 눈에 띄게 표시합니다 (error 색상 사용).
* 이메일 인증 안내는 명확하고 이해하기 쉽게 제공합니다.

#### 데이터 요구사항 및 흐름 (Data Requirements and Data Flow)

* **입력**: 이메일, 비밀번호, 이름, 휴대폰 번호.
* **처리**: 유효성 검사, 중복 확인, 비밀번호 해싱, 이메일 발송, 인증 상태 업데이트, 세션 생성.
* **저장**: customers 테이블 (id, email, hashed\_password, name, phone\_number, auth\_provider='email', is\_active 등).

#### 보안 및 개인정보 고려사항 (Security and Privacy Considerations)

* 비밀번호는 안전하게 해싱하여 저장합니다 (F‑AUTH‑009).
* 이메일 인증 링크는 추측 불가능한 고유 토큰을 포함하고 유효 시간을 설정합니다.
* 개인정보(이메일, 휴대폰 번호)는 안전하게 저장하고 접근을 제어합니다 (NF‑SECU‑002).

---

### UC‑02: 고객 소셜(카카오/네이버) 로그인

| 구분               | 내용                                                                                                                                                        |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 고객                                                                                                                                                        |
| **개요**           | 고객이 카카오 또는 네이버 계정을 이용하여 서비스에 간편하게 로그인합니다.                                                                                                                 |
| **사전 조건**        | 고객이 서비스의 로그인 페이지(P‑001)에 접근한 상태입니다.                                                                                                                       |
| **사후 조건 (성공 시)** | - (최초 로그인 시) 고객 정보가 customers 테이블에 저장됩니다 (auth\_provider는 'kakao' 또는 'naver').<br>- 고객은 로그인 상태가 됩니다.<br>- 고객은 서비스의 기본 페이지(P‑002) 또는 이전에 접근하려던 페이지로 이동합니다. |
| **비즈니스 규칙 및 제약** | - 각 소셜 플랫폼의 로그인 API 연동 규약을 준수해야 합니다.<br>- 소셜 플랫폼에서 제공하는 사용자 정보(이름, 이메일 등)를 활용하여 customers 테이블에 저장합니다.                                                     |

#### 주요 성공 시나리오 (Main Steps and Flow of Events)

1. 고객이 로그인 페이지(P‑001)에서 '카카오로 시작하기' 또는 '네이버로 시작하기' 버튼을 클릭합니다.
2. 시스템은 해당 소셜 플랫폼의 인증 페이지로 리디렉션합니다.
3. 고객은 해당 소셜 플랫폼에서 로그인 및 정보 제공 동의 절차를 진행합니다.
4. 소셜 플랫폼은 인증 성공 후 시스템에 콜백(Callback) 요청과 함께 인증 코드 또는 토큰을 전달합니다.
5. 시스템(백엔드 또는 프론트엔드 콜백 핸들러)은 전달받은 코드를 사용하여 소셜 플랫폼 API를 통해 사용자 정보(고유 ID, 이름, 이메일 등)를 요청합니다.
6. 시스템은 획득한 소셜 플랫폼 고유 ID를 기준으로 customers 테이블에서 기존 사용자 정보를 조회합니다.
7. (기존 사용자 없음 – 최초 소셜 로그인) 시스템은 획득한 사용자 정보(이름, 이메일 등)와 auth\_provider, provider\_id를 포함하여 customers 테이블에 새로운 레코드를 생성합니다 (role='customer', is\_active=true).
8. (기존 사용자 있음) 시스템은 해당 사용자로 로그인 처리합니다. (선택적으로 소셜 플랫폼의 최신 정보로 customers 테이블 업데이트 가능)
9. 시스템은 로그인 세션을 생성하고 고객을 해당 페이지로 리디렉션합니다.

#### 대체 흐름 및 예외 처리

* **3a. 소셜 로그인 실패/취소**: 고객이 소셜 플랫폼 인증을 실패하거나 취소하면, 시스템은 오류 메시지와 함께 로그인 페이지(P‑001)로 돌아옵니다.
* **5a. 소셜 플랫폼 API 오류**: 사용자 정보 요청 중 오류 발생 시, 시스템은 "소셜 로그인 중 오류가 발생했습니다. 잠시 후 다시 시도해주세요." 메시지를 표시합니다.
* **7a. DB 저장 실패 (최초 로그인 시)**: 시스템은 "로그인 처리 중 오류가 발생했습니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 소셜 로그인 버튼은 각 플랫폼의 공식 디자인 가이드라인을 따릅니다.
* 로그인 진행 중임을 나타내는 로딩 상태를 표시할 수 있습니다.

#### 데이터 요구사항 및 흐름

* **입력**: 소셜 로그인 버튼 클릭 이벤트.
* **처리**: 소셜 플랫폼 인증 연동, 콜백 처리, 사용자 정보 요청, DB 조회/저장, 세션 생성.
* **저장**: customers 테이블 (최초 로그인 시).

#### 보안 및 개인정보 고려사항

* OAuth 2.0 표준 및 각 플랫폼 보안 가이드라인을 준수합니다 (NF‑SECU‑000).
* 소셜 플랫폼에서 받은 사용자 정보는 필요한 범위 내에서만 수집하고 안전하게 관리합니다.

---

### UC‑03: 고객 비밀번호 찾기 및 재설정

| 구분               | 내용                                                                                                         |
| ---------------- | ---------------------------------------------------------------------------------------------------------- |
| **액터**           | 고객 (이메일 로그인 사용자)                                                                                           |
| **개요**           | 이메일로 가입한 고객이 비밀번호를 잊었을 경우, 이메일을 통해 비밀번호를 재설정합니다.                                                           |
| **사전 조건**        | 고객이 로그인 페이지(P‑001)에 접근한 상태입니다.                                                                             |
| **사후 조건 (성공 시)** | - 고객의 비밀번호가 새로 설정한 비밀번호로 업데이트됩니다 (해싱됨).<br>- 고객은 새 비밀번호로 로그인할 수 있습니다.                                      |
| **비즈니스 규칙 및 제약** | - 가입 시 사용한 이메일 주소를 정확히 입력해야 합니다.<br>- 비밀번호 재설정 링크는 유효 시간이 제한됩니다.<br>- 새 비밀번호는 기존 비밀번호 정책(복잡도 등)을 만족해야 합니다. |

#### 주요 성공 시나리오

1. 고객이 로그인 페이지(P‑001)에서 '비밀번호 찾기' 링크를 클릭합니다.
2. 시스템은 비밀번호 찾기 페이지(P‑010)를 표시합니다.
3. 고객은 가입 시 사용한 이메일 주소를 입력하고 '재설정 링크 받기' 버튼을 클릭합니다.
4. 시스템은 해당 이메일 주소가 customers 테이블에 존재하는지 확인합니다.
5. (존재 시) 시스템은 유효 시간이 포함된 비밀번호 재설정 토큰을 생성하고, 해당 토큰이 포함된 재설정 링크를 이메일로 발송합니다.
6. 시스템은 고객에게 "이메일로 비밀번호 재설정 안내를 발송했습니다." 메시지를 표시합니다.
7. 고객은 수신한 이메일에서 재설정 링크를 클릭합니다.
8. 시스템은 링크의 토큰 유효성(존재 여부, 만료 시간)을 검증합니다.
9. (유효 시) 시스템은 비밀번호 재설정 페이지(P‑011)를 표시합니다.
10. 고객은 새 비밀번호와 새 비밀번호 확인을 입력하고 '비밀번호 변경' 버튼을 클릭합니다.
11. 시스템은 새 비밀번호의 유효성(복잡도 등) 및 일치 여부를 검사합니다.
12. (유효성 통과 시) 시스템은 새 비밀번호를 해싱하여 해당 고객의 customers 테이블 정보를 업데이트하고, 사용된 재설정 토큰을 무효화합니다.
13. 시스템은 "비밀번호가 성공적으로 변경되었습니다. 새 비밀번호로 로그인해주세요." 메시지를 표시하고 로그인 페이지(P‑001)로 이동시킵니다.

#### 대체 흐름 및 예외 처리

* **4a. 가입되지 않은 이메일**: 시스템은 "가입되지 않은 이메일 주소입니다." 메시지를 표시합니다.
* **7a. 이메일 미수신**: 고객은 잠시 후 다시 시도하거나 스팸함을 확인합니다. (재발송 버튼 고려)
* **8a. 재설정 링크 만료 또는 무효**: 시스템은 "유효하지 않거나 만료된 링크입니다. 비밀번호 찾기를 다시 시도해주세요." 메시지를 표시합니다.
* **11a. 새 비밀번호 유효성 검사 실패**: 시스템은 오류 내용(예: "비밀번호는 8자 이상이어야 합니다.", "비밀번호가 일치하지 않습니다.")을 표시하고 변경 절차를 중단합니다.
* **12a. DB 업데이트 실패**: 시스템은 "비밀번호 변경 중 오류가 발생했습니다. 다시 시도해주세요." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 비밀번호 찾기(P‑010) 및 재설정(P‑011) 페이지는 간결하고 명확해야 합니다.
* 이메일 발송 안내, 링크 유효 시간 안내 등을 명확히 제공합니다.
* 새 비밀번호 입력 시 복잡도 요구사항을 안내하고 실시간 피드백을 제공할 수 있습니다.

#### 데이터 요구사항 및 흐름

* **입력**: 이메일 주소, 새 비밀번호, 새 비밀번호 확인.
* **처리**: 이메일 존재 확인, 재설정 토큰 생성/검증, 이메일 발송, 비밀번호 유효성 검사, 비밀번호 해싱, DB 업데이트.
* **저장**: customers 테이블 (hashed\_password 업데이트). (재설정 토큰은 임시 저장 또는 별도 관리)

#### 보안 및 개인정보 고려사항

* 재설정 링크 토큰은 추측 불가능하고 일회성이며 유효 시간이 짧아야 합니다.
* 이메일 발송 시 스팸 처리되지 않도록 유의합니다.
* 비밀번호 재설정 과정에서 사용자 식별 정보 노출을 최소화합니다.

---

### UC‑04: 고객 로그아웃

| 구분               | 내용                                                                                                     |
| ---------------- | ------------------------------------------------------------------------------------------------------ |
| **액터**           | 고객                                                                                                     |
| **개요**           | 로그인된 고객이 서비스에서 로그아웃합니다.                                                                                |
| **사전 조건**        | 고객이 로그인된 상태입니다.                                                                                        |
| **사후 조건 (성공 시)** | - 고객의 로그인 세션이 종료됩니다.<br>- 고객은 로그아웃 상태가 되며, 헤더 등 UI가 비로그인 상태로 변경됩니다.<br>- 고객은 메인 페이지 또는 로그인 페이지로 이동합니다. |

#### 주요 성공 시나리오

1. 고객이 헤더 또는 마이페이지(P‑005)의 '로그아웃' 버튼을 클릭합니다.
2. 시스템은 현재 로그인 세션을 종료(무효화)합니다.
3. 시스템은 고객을 메인 페이지 또는 로그인 페이지(P‑001)로 리디렉션합니다.
4. 헤더 등 UI가 비로그인 상태로 업데이트됩니다.

#### 대체 흐름 및 예외 처리

* **2a. 세션 종료 실패**: 시스템은 내부 오류 로그를 기록하고, 사용자에게는 "로그아웃 중 오류가 발생했습니다." 메시지를 표시하거나, 클라이언트 측에서만 로그아웃 처리합니다.

#### 사용자 인터페이스 고려사항

* '로그아웃' 버튼은 명확하게 식별 가능해야 합니다.

#### 데이터 요구사항 및 흐름

* **입력**: 로그아웃 버튼 클릭 이벤트.
* **처리**: 세션 종료.

#### 보안 및 개인정보 고려사항

* 로그아웃 시 세션 관련 정보(쿠키, 토큰 등)가 안전하게 제거되어야 합니다.

---

### UC‑05: 고객 회원 탈퇴

| 구분               | 내용                                                                                                                                                                   |
| ---------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 고객                                                                                                                                                                   |
| **개요**           | 고객이 마이페이지에서 회원 탈퇴 절차를 진행합니다.                                                                                                                                         |
| **사전 조건**        | 고객이 로그인된 상태이며, 마이페이지(P‑005)에 접근한 상태입니다.                                                                                                                              |
| **사후 조건 (성공 시)** | - 고객 계정이 즉시 비활성화됩니다 (customers.is\_active = false).<br>- 고객은 더 이상 해당 계정으로 로그인할 수 없습니다.<br>- 30일 유예 기간 후 개인 식별 정보가 익명화 처리됩니다.<br>- 고객은 탈퇴 완료 안내 페이지 또는 메인 페이지로 이동합니다. |
| **비즈니스 규칙 및 제약** | - 탈퇴 시 보유한 "적립 시간" 및 "쿠폰 시간"은 모두 소멸됩니다.<br>- 탈퇴 시 예약 내역 접근이 불가합니다.<br>- 탈퇴 후 일정 기간 재가입이 제한될 수 있습니다 (정책 결정 필요).                                                       |

#### 주요 성공 시나리오

1. 고객이 마이페이지(P‑005)에서 '회원 탈퇴' 버튼을 클릭합니다.
2. 시스템은 탈퇴 시 유의사항(적립/쿠폰 시간 소멸, 예약 접근 불가 등)을 명확히 안내하고, 최종 탈퇴 의사를 확인하는 인터페이스(예: 비밀번호 재입력 또는 "탈퇴에 동의합니다" 문구 입력)를 표시합니다.
3. 고객은 안내 사항을 확인하고, 비밀번호 재입력 등 확인 절차를 수행한 후 '탈퇴하기' 버튼을 클릭합니다.
4. 시스템은 확인 절차의 유효성을 검증합니다.
5. (유효성 통과 시) 시스템은 해당 고객의 customers 테이블 is\_active 컬럼을 false로 업데이트하고, deleted\_at 타임스탬프를 기록합니다.
6. 시스템은 현재 고객 세션을 즉시 종료(강제 로그아웃)시킵니다.
7. 시스템은 "회원 탈퇴가 정상적으로 처리되었습니다." 메시지를 표시하고 메인 페이지 등으로 이동시킵니다.
8. (백엔드 스케줄링) 시스템은 deleted\_at 기준으로 30일이 경과한 비활성 계정에 대해 개인 식별 정보 익명화 작업을 수행합니다.

#### 대체 흐름 및 예외 처리

* **4a. 탈퇴 확인 절차 실패**: 시스템은 "비밀번호가 일치하지 않습니다." 또는 "확인 문구가 올바르지 않습니다." 메시지를 표시하고 탈퇴 절차를 중단합니다.
* **5a. DB 업데이트 실패**: 시스템은 "회원 탈퇴 처리 중 오류가 발생했습니다. 다시 시도해주세요." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* '회원 탈퇴' 버튼은 눈에 잘 띄지 않는 곳(예: 계정 설정 하단)에 배치하는 것이 일반적입니다.
* 탈퇴 유의사항 안내는 명확하고 이해하기 쉬워야 합니다.
* 최종 확인 절차는 사용자의 실수를 방지할 수 있도록 설계되어야 합니다.

#### 데이터 요구사항 및 흐름

* **입력**: 탈퇴 확인 정보 (비밀번호 또는 확인 문구).
* **처리**: 입력 정보 검증, 계정 비활성화(is\_active 업데이트), deleted\_at 기록, 세션 종료, (스케줄링) 익명화 처리.
* **저장**: customers 테이블 (is\_active, deleted\_at 업데이트).

#### 보안 및 개인정보 고려사항

* 본인 확인 절차(비밀번호 재입력 등)를 통해 타인에 의한 탈퇴를 방지합니다.
* 개인정보 처리 방침에 따라 탈퇴 후 정보 처리(익명화)를 수행합니다 (NF‑SECU‑009).

---

### UC‑06: 운영자 이메일 로그인

| 구분               | 내용                                                                     |
| ---------------- | ---------------------------------------------------------------------- |
| **액터**           | 운영자                                                                    |
| **개요**           | 운영자가 지정된 이메일 주소와 비밀번호를 사용하여 관리 페이지에 로그인합니다.                            |
| **사전 조건**        | 운영자가 로그인 페이지(P‑001) 또는 별도 관리자 로그인 경로에 접근한 상태입니다. 초기 운영자 계정이 생성되어 있습니다. |
| **사후 조건 (성공 시)** | - 운영자는 로그인 상태가 됩니다.<br>- 운영자는 운영자 관리 대시보드(P‑101)로 이동합니다.               |
| **비즈니스 규칙 및 제약** | customers 테이블의 role이 'admin'인 사용자만 운영자 로그인이 가능합니다.                     |

#### 주요 성공 시나리오

1. 운영자가 로그인 페이지(P‑001)에서 이메일과 비밀번호를 입력하고 '로그인' 버튼을 클릭합니다.
2. 시스템은 입력된 정보와 저장된 고객 정보를 비교하여 인증을 수행합니다 (F‑AUTH‑005).
3. (인증 성공 시) 시스템은 해당 사용자의 customers 테이블 role 컬럼 값을 확인합니다.
4. (role이 'admin'일 경우) 시스템은 운영자 로그인 세션을 생성하고 운영자를 관리자 대시보드(P‑101)로 리디렉션합니다 (F‑AUTH‑017).

#### 대체 흐름 및 예외 처리

* **2a. 로그인 정보 불일치**: 시스템은 "이메일 또는 비밀번호가 올바르지 않습니다." 메시지를 표시합니다.
* **4a. 운영자 권한 없음 (role != 'admin')**: 시스템은 "접근 권한이 없습니다." 메시지를 표시하거나 일반 사용자 페이지(P‑002)로 리디렉션합니다.

#### 사용자 인터페이스 고려사항

* 일반 고객 로그인 폼과 동일한 폼을 사용합니다.

#### 데이터 요구사항 및 흐름

* **입력**: 운영자 이메일, 비밀번호.
* **처리**: 인증 수행, 역할 확인, 세션 생성, 리디렉션.
* **조회**: customers 테이블 (email, hashed\_password, role).

#### 보안 및 개인정보 고려사항

* 운영자 계정 정보는 안전하게 관리되어야 하며, 일반 사용자와 동일한 비밀번호 보안 정책이 적용됩니다.

---

### UC‑07: 고객 서비스 상세 정보 및 리뷰 조회

| 구분               | 내용                                                         |
| ---------------- | ---------------------------------------------------------- |
| **액터**           | 고객 (로그인/비로그인 상태 모두 가능)                                     |
| **개요**           | 고객이 서비스 상세 페이지에 접근하여 서비스 정보, 예약 가능 시간, 다른 사용자들의 리뷰를 확인합니다. |
| **사전 조건**        | 고객이 서비스 상세 페이지(P‑002) URL에 접근했습니다.                         |
| **사후 조건 (성공 시)** | 고객은 페이지에 표시된 서비스 정보, 예약 인터페이스, 리뷰 등을 조회할 수 있습니다.           |

#### 주요 성공 시나리오

1. 고객이 서비스 상세 페이지(P‑002)에 접근합니다.
2. 시스템은 URL의 serviceId를 기반으로 services 테이블에서 해당 서비스 정보를 조회합니다.
3. 시스템은 reviews 테이블에서 해당 서비스의 리뷰 목록(숨김/삭제 제외) 및 평균 별점/총 리뷰 수를 조회하거나 계산합니다.
4. 시스템은 현재 날짜 기준으로 예약 가능한 날짜 및 시간 슬롯 정보를 조회합니다 (reservations, holidays 테이블 등 참조).
5. 시스템은 조회된 모든 정보를 페이지 UI에 렌더링하여 고객에게 표시합니다. (서비스 정보, 예약 인터페이스, 리뷰 목록 등)

#### 대체 흐름 및 예외 처리

* **2a. 유효하지 않은 serviceId**: 시스템은 "서비스 정보를 찾을 수 없습니다." 오류 페이지 또는 메시지를 표시합니다.
* **3a/4a. 데이터 조회 실패**: 시스템은 "정보를 불러오는 중 오류가 발생했습니다." 메시지를 표시하거나, 해당 영역을 비워두거나 로딩 실패 상태를 표시합니다.

#### 사용자 인터페이스 고려사항

* 페이지 로딩 시 스켈레톤 UI 등을 사용하여 사용자 경험을 개선합니다.
* 정보량이 많으므로 탭 구조 등을 활용하여 콘텐츠를 효과적으로 조직화합니다.
* 리뷰 목록은 페이지네이션 또는 '더보기' 버튼을 통해 로딩 성능을 관리합니다.

#### 데이터 요구사항 및 흐름

* **입력**: 서비스 ID (serviceId).
* **처리**: DB 조회 (services, reviews, reservations, holidays 등).
* **출력**: 서비스 상세 정보, 예약 가능 시간 슬롯, 리뷰 목록, 평균 별점, 리뷰 수.

#### 보안 및 개인정보 고려사항

* 리뷰 작성자 이름은 마스킹 처리하여 표시합니다.

---

### UC‑08: 고객 예약 신청 (날짜/시간 선택, 정보 입력, 적립/쿠폰 시간 사용)

| 구분               | 내용                                                                                                                                                                                            |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 고객                                                                                                                                                                                            |
| **개요**           | 고객이 서비스 상세 페이지에서 날짜와 시간을 선택하고 필요한 정보를 입력하여 예약을 신청합니다. 이 과정에서 보유한 적립 시간과 쿠폰을 사용할 수 있습니다.                                                                                                   |
| **사전 조건**        | 고객이 로그인 상태이며, 서비스 상세 페이지(P‑002)에 접근한 상태입니다.                                                                                                                                                  |
| **사후 조건 (성공 시)** | - 예약 정보(reservations 테이블)가 생성됩니다.<br>- *(적립/쿠폰 시간 사용 시)* 고객의 적립 시간이 차감되거나 쿠폰이 사용됩니다.<br>- 고객은 결제 단계(선택 항목)로 이동합니다.<br>- 고객 및 운영자에게 예약 접수 알림톡이 발송됩니다.                                      |
| **비즈니스 규칙 및 제약** | - 예약은 서비스 운영 시간 내에만 가능합니다.<br>- 동일한 시간에 중복 예약이 불가합니다.<br>- 적립/쿠폰 시간은 최소 단위(30분) 이상 예약 시 사용 가능합니다.<br>- 휴무일 및 특정 날짜의 예약 불가 시간에는 예약할 수 없습니다.<br>- 오늘인 경우, 현재 시간 이후의 시간대만 선택 가능합니다. |

#### 주요 성공 시나리오 (Main Steps and Flow of Events)

1. 고객이 서비스 상세 페이지(P‑002)의 예약 섹션에서 캘린더를 통해 날짜를 선택합니다.
2. 시스템은 해당 날짜의 예약 가능 정보(운영 시간: `operatingStartTime`, `operatingEndTime`, 기존 예약 상태, 휴무일 여부: `isClosed`, `message` 등)를 API를 통해 조회하여 시간 선택 UI에 표시합니다.
3. 고객이 시간 슬롯 피커(Time Slot Picker)를 통해 이용 희망 시간을 선택합니다.
   * 시간 선택 UI는 00:00부터 23:30까지 30분 단위 슬롯을 모두 표시합니다.
   * UI 상단에는 각 시간 슬롯의 시작 경계를 나타내는 눈금과 시간 레이블이 표시됩니다.
   * 정각 시간(예: 06:00, 13:00)에는 굵은 세로 눈금과 'HH:00' 형식의 24시간제 레이블이 표시되고, 30분 시간(예: 06:30, 13:30)에는 얇은 세로 눈금과 'HH:30' 형식의 24시간제 레이블이 표시됩니다.
   * 각 30분 슬롯 박스는 연속된 두 눈금 사이 공간을 차지하며 내부에 별도의 시간 텍스트는 표시되지 않습니다.
   * 예약 가능한 시간 슬롯과 불가능한 시간 슬롯은 시각적으로 명확히 구분됩니다.
   * 최초 시간 선택 시 자동으로 1시간(2개 연속 슬롯)이 선택되며, 이후 30분씩 범위를 확장할 수 있습니다.
   * 선택된 슬롯이 2개(1시간)일 때 그 중 하나를 클릭하면 전체 선택이 취소됩니다.
   * 연속적이지 않은 위치를 선택할 경우 새로운 선택 지점부터 자동으로 1시간이 선택됩니다.
4. 고객이 이름, 업체명, 촬영 목적, 차량번호, 요청 사항 등 필요한 정보를 입력합니다.
5. 시스템은 고객의 계정 정보에서 보유 적립 시간과 사용 가능한 쿠폰 정보를 조회하여 사용 가능한 시간을 표시합니다.
6. 고객이 보유 시간(적립/쿠폰)을 사용할지 선택합니다.
7. 고객이 개인정보 수집/이용 동의에 체크하고 '예약하기' 버튼을 클릭합니다.
8. 시스템은 입력된 정보의 유효성을 검사합니다 (필수 항목 입력 여부, 예약 시간 유효성 등).
9. (유효성 통과 시) 시스템은 예약 정보를 백엔드에 전송합니다.
10. 백엔드는 해당 시간의 예약 가능 여부를 다시 확인합니다 (동시 접근에 의한 충돌 방지).
11. (예약 가능 시) 백엔드는 reservations 테이블에 예약 정보를 생성합니다.
12. (적립/쿠폰 시간 사용 시) 백엔드는 customers 테이블의 `accumulated_time_minutes` 차감 또는 customer\_coupons 테이블의 사용 여부 업데이트를 수행합니다.
13. 백엔드는 성공 응답을 반환합니다.
14. 시스템은 고객에게 예약 성공 메시지를 표시하고 결제(필요 시) 또는 완료 단계로 이동시킵니다.
15. (비동기) 시스템은 고객과 운영자에게 예약 접수 알림톡(F‑NOTI‑001)을 발송합니다.

#### 대체 흐름 및 예외 처리

* **4a. 입력 정보 유효성 검사 실패**: 시스템은 오류가 발생한 입력 필드와 오류 내용을 명확하게 표시하고 예약 절차를 중단합니다.
* **5a. 이미 가입된 이메일/휴대폰**: 시스템은 "이미 가입된 이메일 주소입니다." 또는 "이미 등록된 휴대폰 번호입니다." 메시지를 표시합니다.
* **7a. 이메일 미수신**: 고객은 재발송 요청 기능을 사용할 수 있습니다 (기능 추가 필요).
* **8a. 인증 링크 만료 또는 무효**: 시스템은 "유효하지 않거나 만료된 인증 링크입니다." 메시지를 표시하고, 필요한 경우 인증 메일 재발송을 안내합니다.
* **11a. 로그인 정보 불일치**: 시스템은 "이메일 또는 비밀번호가 올바르지 않습니다." 메시지를 표시합니다.
* **11b. 계정 비활성화 상태**: 시스템은 "이메일 인증이 필요하거나 비활성화된 계정입니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 예약 정보 입력 폼(P‑003)과 예약 가능 시간 선택 인터페이스(P‑004)는 명확한 레이블과 플레이스홀더를 제공합니다.
* 예약 정보 입력 시 복잡도 요구사항을 안내하고 실시간 피드백을 제공할 수 있습니다.

#### 데이터 요구사항 및 흐름

* **입력**: 예약 정보(주문 ID, 결제 금액, 적립/쿠폰 시간), 고객 결제 정보(PortOne 처리).
* **처리**: 유효성 검사, 중복 확인, 비밀번호 해싱, 이메일 발송, 인증 상태 업데이트, 세션 생성, 예약 가능 시간 선택, 예약 정보 저장, 결제 요청, 결과 반환.
* **입력**: 예약 정보(주문 ID, 결제 금액), 고객 결제 정보(PortOne 처리).
* **처리**: PortOne SDK 호출, 결제 처리(PortOne), 결과 반환, 웹훅 발송(PortOne).
* **출력**: 결제 성공/실패 결과.

#### 보안 및 개인정보 고려사항

* 신용카드 등 민감한 결제 정보는 서비스 시스템에서 직접 처리하거나 저장하지 않고 PortOne 모듈 내에서 안전하게 처리됩니다 (NF‑SECU‑001).
* 결제 관련 통신은 HTTPS를 사용합니다.

---

### UC‑10: 고객 예약 변경

| 구분               | 내용                                                                                                                                                                                   |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **액터**           | 고객                                                                                                                                                                                   |
| **개요**           | 고객이 마이페이지에서 기존 예약의 날짜 또는 시간을 변경합니다.                                                                                                                                                  |
| **유스케이스**        | UC‑10은 F‑MGMT‑M 기능 요구사항 그룹과 관련됩니다.                                                                                                                                                   |
| **사전 조건**        | - 고객이 로그인된 상태입니다.<br>- 고객이 마이페이지(P‑005)의 예약 내역을 보고 있습니다.<br>- 변경하려는 예약이 존재하며, 예약 시작 1분 전입니다 (F‑MGMT‑M‑001).                                                                          |
| **사후 조건 (성공 시)** | - 해당 예약 정보(reservations 테이블)의 시작/종료 시간이 변경되고 상태가 `modified`로 업데이트됩니다.<br>- 고객 및 운영자에게 예약 변경 알림톡이 발송됩니다.<br>- 고객은 변경 완료 안내를 받습니다.                                                     |
| **비즈니스 규칙 및 제약** | - 예약 시작 1분 전까지만 변경 가능합니다 (F‑MGMT‑M‑001).<br>- 변경 횟수에는 제한이 없습니다 (F‑MGMT‑M‑002).<br>- 변경하려는 새로운 시간 슬롯이 예약 가능해야 합니다 (F‑MGMT‑M‑005).<br>- 시간 선택 규칙(최소 1시간 등)은 동일하게 적용됩니다 (F‑MGMT‑M‑004). |

#### 주요 성공 시나리오

1. 고객이 마이페이지(P‑005)에서 변경 가능한 예약 건의 '예약 변경' 버튼을 클릭합니다.
2. 시스템은 예약 변경 인터페이스(P‑008, 모달 또는 페이지)를 표시합니다.
3. 고객은 캘린더와 시간 슬롯을 사용하여 변경을 원하는 새 날짜와 시간을 선택합니다.
4. 시스템은 선택된 시간의 예약 가능 여부를 실시간으로 확인하고 피드백합니다.
5. (예약 가능 시) 고객은 ‘변경 완료' 버튼을 클릭합니다.
6. 시스템은 백엔드(Edge Function 또는 API)에 변경 요청을 보냅니다.
7. 백엔드는 요청 유효성(변경 가능 시한, 시간 슬롯 중복 등)을 재검증합니다.
8. (유효성 통과 시) 백엔드는 reservations 테이블의 해당 예약 정보를 업데이트하고 상태를 `modified`로 변경합니다 (트랜잭션 처리).
9. 백엔드는 성공 응답을 프론트엔드로 보냅니다.
10. 시스템은 고객에게 "예약이 성공적으로 변경되었습니다.” 메시지를 표시하고 마이페이지 예약 내역을 갱신합니다.
11. (비동기) 시스템은 고객과 운영자에게 예약 변경 알림톡(F‑NOTI‑009)을 발송합니다.

#### 대체 흐름 및 예외 처리

* **1a. 변경 불가 조건**: ‘예약 변경' 버튼이 비활성화되어 있거나 표시되지 않습니다.
* **4a. 선택 시간 예약 불가**: 시스템은 "선택하신 시간은 예약이 불가능합니다.” 메시지를 표시하고 변경 완료 버튼을 비활성화합니다.
* **7a. 백엔드 유효성 검증 실패**: 시스템은 오류 내용(예: "변경 가능 시간이 지났습니다.”, "선택한 시간이 중복됩니다.”)을 고객에게 표시합니다.
* **8a. DB 업데이트 실패**: 시스템은 "예약 변경 중 오류가 발생했습니다.” 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 예약 변경 UI(P‑008)는 기존 예약 정보와 새 시간 선택 인터페이스를 명확히 구분하여 보여줘야 합니다.

#### 데이터 요구사항 및 흐름

* **입력**: 변경 대상 예약 ID, 새로운 시작/종료 시간.
* **처리**: 변경 가능 시한 확인, 새 시간 슬롯 예약 가능 여부 확인, DB 업데이트, 알림 발송.
* **저장**: reservations 테이블 업데이트.

#### 보안 및 개인정보 고려사항

* 본인의 예약만 변경 가능하도록 서버 측에서 권한을 확인해야 합니다.

---

### UC‑11: 고객 예약 취소

| 구분               | 내용                                                                                                                                                      |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 고객                                                                                                                                                      |
| **개요**           | 고객이 마이페이지에서 예약을 취소하고 환불받습니다.                                                                                                                            |
| **유스케이스**        | UC‑11은 F‑MGMT‑C 기능 요구사항 그룹과 관련됩니다.                                                                                                                      |
| **사전 조건**        | - 고객이 로그인된 상태입니다.<br>- 고객이 마이페이지(P‑005)의 예약 내역을 보고 있습니다.<br>- 취소하려는 예약이 존재하며, 예약 시작 31분 전입니다 (F‑MGMT‑C‑001).                                            |
| **사전 조건**        | - 고객이 로그인된 상태입니다.<br>- 고객이 마이페이지(P‑005)의 예약 내역을 보고 있습니다.<br>- 취소하려는 예약이 존재하며, 예약 시작 31분 전입니다 (F‑MGMT‑C‑001).                                            |
| **사후 조건 (성공 시)** | - 해당 예약 정보(reservations 테이블)의 상태가 `cancelled`로 변경됩니다.<br>- PortOne을 통해 결제 금액이 100% 환불 처리됩니다.<br>- 고객 및 운영자에게 예약 취소 알림톡이 발송됩니다.<br>- 고객은 취소 완료 안내를 받습니다. |
| **비즈니스 규칙 및 제약** | 예약 시작 31분 전까지만 취소 및 100% 환불이 가능합니다 (F‑MGMT‑C‑001).                                                                                                      |

#### 주요 성공 시나리오

1. 고객이 마이페이지(P‑005)에서 취소 가능한 예약 건의 ‘예약 취소' 버튼을 클릭합니다.
2. 시스템은 “정말로 예약을 취소하시겠습니까? 전액 환불됩니다.” 와 같은 확인 팝업을 표시합니다.
3. 고객은 ‘확인' 버튼을 클릭합니다.
4. 시스템은 백엔드(Edge Function 또는 API)에 취소 요청을 보냅니다.
5. 백엔드는 요청 유효성(취소 가능 시한)을 재검증합니다.
6. (유효성 통과 시) 백엔드는 PortOne 환불 API를 호출하여 결제 금액 전액 환불을 시도합니다.
7. (환불 성공 시) 백엔드는 reservations 테이블의 해당 예약 상태를 `cancelled`로 업데이트합니다 (트랜잭션 처리).
8. 백엔드는 성공 응답을 프론트엔드로 보냅니다.
9. 시스템은 고객에게 "예약이 취소되고 환불 처리되었습니다.” 메시지를 표시하고 마이페이지 예약 내역을 갱신합니다.
10. (비동기) 시스템은 고객과 운영자에게 예약 취소 알림톡(F‑NOTI‑008)을 발송합니다.

#### 대체 흐름 및 예외 처리

* **1a. 취소 불가 조건**: ‘예약 취소' 버튼이 비활성화되어 있거나 표시되지 않습니다.
* **5a. 백엔드 유효성 검증 실패**: 시스템은 “취소 가능 시간이 지났습니다.” 메시지를 고객에게 표시합니다.
* **6a. PortOne 환불 실패**: 시스템은 “환불 처리 중 오류가 발생했습니다. 관리자에게 문의해주세요.” 메시지를 표시하고 예약 상태는 변경하지 않습니다. *(운영자에게 별도 알림 필요)*
* **7a. DB 업데이트 실패**: 시스템은 “예약 취소 처리 중 오류가 발생했습니다.” 메시지를 표시합니다. *(환불 롤백 필요 여부 확인)*

#### 사용자 인터페이스 고려사항

* 취소는 되돌릴 수 없으므로 명확한 확인 절차를 거쳐야 합니다.
* 환불 처리 소요 시간에 대한 안내를 포함할 수 있습니다.

#### 데이터 요구사항 및 흐름

* **입력**: 취소 대상 예약 ID.
* **처리**: 취소 가능 시한 확인, PortOne 환불 API 호출, DB 업데이트, 알림 발송.
* **저장**: reservations 테이블 업데이트.

#### 보안 및 개인정보 고려사항

* 본인의 예약만 취소 가능하도록 서버 측에서 권한을 확인해야 합니다.
* 환불 처리 시 필요한 결제 정보(거래 ID 등)를 안전하게 사용해야 합니다.

---

### UC‑13: 고객 리뷰 수정

| 구분               | 내용                                                                                                                              |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 고객                                                                                                                              |
| **개요**           | 고객이 마이페이지에서 자신이 작성한 리뷰의 별점, 텍스트, 이미지를 수정합니다.                                                                                    |
| **사전 조건**        | - 고객이 로그인된 상태입니다.<br>- 고객이 마이페이지(P‑005)의 ‘내 리뷰' 목록에 접근했습니다.<br>- 수정하려는 리뷰가 존재합니다.                                               |
| **사후 조건 (성공 시)** | - 해당 리뷰 정보(reviews 테이블)가 수정된 내용으로 업데이트됩니다.<br>- 서비스 상세 페이지(P‑002)의 리뷰 내용 및 평균 별점/리뷰 수가 업데이트됩니다.<br>- 고객은 수정 완료 안내를 받습니다.        |
| **비즈니스 규칙 및 제약** | - 자신이 작성한 리뷰만 수정할 수 있습니다.<br>- 수정 시에도 텍스트 길이 제한(10\~100자), 이미지 개수 제한(최대 5장) 등은 동일하게 적용됩니다.<br>- 리뷰 수정 시에는 적립 시간이 추가로 부여되지 않습니다. |

#### 주요 성공 시나리오

1. 고객이 마이페이지(P‑005) ‘내 리뷰' 목록에서 수정할 리뷰의 '수정' 버튼을 클릭합니다.
2. 시스템은 리뷰 수정 인터페이스(P‑009, 작성 UI 재사용)를 표시하고 기존 리뷰 내용(별점, 텍스트, 이미지)을 불러와 보여줍니다.
3. 고객은 별점, 텍스트, 이미지를 수정합니다. *(이미지 추가/삭제 가능)*
4. 고객은 ‘수정 완료' 버튼을 클릭합니다.
5. 시스템은 수정된 내용의 유효성(별점 필수, 텍스트 길이)을 검사합니다.
6. (유효성 통과 시) 시스템은 수정된 리뷰 정보 및 이미지 변경 사항을 서버로 전송합니다.
7. 서버는 이미지 변경 사항(추가/삭제)을 Storage에 반영하고 URL 목록을 업데이트합니다.
8. 서버는 reviews 테이블의 해당 리뷰 레코드를 수정된 내용(별점, 텍스트, 이미지 URL 목록, updated\_at)으로 업데이트합니다.
9. *(고려)* 서버는 서비스 평균 별점/리뷰 수를 재계산하여 업데이트합니다.
10. 시스템은 고객에게 "리뷰가 성공적으로 수정되었습니다." 메시지를 표시하고 마이페이지 '내 리뷰' 목록을 갱신합니다.

#### 대체 흐름 및 예외 처리

* **5a. 유효성 검사 실패**: 시스템은 오류 내용을 표시하고 수정 절차를 중단합니다.
* **7a. 이미지 처리 실패**: 시스템은 오류 메시지를 표시하고 수정을 중단하거나, 이미지 변경 없이 텍스트만 수정할지 묻습니다.
* **8a. DB 업데이트 실패**: 시스템은 "리뷰 수정 중 오류가 발생했습니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 리뷰 작성 UI(P‑009)를 재사용하여 일관성을 유지합니다.
* 기존 내용을 명확히 보여주고 수정할 수 있도록 합니다.

#### 데이터 요구사항 및 흐름

* **입력**: 수정 대상 리뷰 ID, 수정된 별점, 텍스트, 추가/삭제된 이미지 파일.
* **처리**: 유효성 검사, 이미지 업로드/삭제, 텍스트 정제, DB 업데이트(reviews), 평균 별점/리뷰 수 재계산.
* **저장**: reviews 테이블 업데이트.

#### 보안 및 개인정보 고려사항

* 본인의 리뷰만 수정 가능하도록 서버 측에서 권한을 확인해야 합니다 (NF‑SECU‑007).

---

### UC‑14: 고객 리뷰 삭제

| 구분               | 내용                                                                                                                                          |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 고객                                                                                                                                          |
| **개요**           | 고객이 마이페이지에서 자신이 작성한 리뷰를 삭제합니다.                                                                                                              |
| **사전 조건**        | - 고객이 로그인된 상태입니다.<br>- 고객이 마이페이지(P‑005)의 ‘내 리뷰' 목록에 접근했습니다.<br>- 삭제하려는 리뷰가 존재합니다.                                                           |
| **사후 조건 (성공 시)** | - 해당 리뷰 정보(reviews 테이블)가 삭제되거나 비활성화 처리됩니다 (deleted\_at 업데이트).<br>- 서비스 상세 페이지(P‑002)의 리뷰 목록 및 평균 별점/리뷰 수가 업데이트됩니다.<br>- 고객은 삭제 완료 안내를 받습니다. |
| **비즈니스 규칙 및 제약** | - 자신이 작성한 리뷰만 삭제할 수 있습니다.<br>- 리뷰 삭제 시 부여되었던 적립 시간은 회수하지 않습니다 (F‑MGMT‑R‑010).                                                               |

#### 주요 성공 시나리오

1. 고객이 마이페이지(P‑005) ‘내 리뷰' 목록에서 삭제할 리뷰의 '삭제' 버튼을 클릭합니다.
2. 시스템은 "정말로 이 리뷰를 삭제하시겠습니까?" 확인 팝업을 표시합니다.
3. 고객은 '확인' 버튼을 클릭합니다.
4. 시스템은 백엔드에 삭제 요청을 보냅니다.
5. 백엔드는 해당 리뷰의 deleted\_at 타임스탬프를 업데이트하거나 레코드를 삭제합니다 *(정책 결정 필요)*.
6. *(고려)* 백엔드는 서비스 평균 별점/리뷰 수를 재계산하여 업데이트합니다.
7. 백엔드는 성공 응답을 프론트엔드로 보냅니다.
8. 시스템은 고객에게 "리뷰가 삭제되었습니다." 메시지를 표시하고 마이페이지 '내 리뷰' 목록을 갱신합니다.

#### 대체 흐름 및 예외 처리

* **5a. DB 처리 실패**: 시스템은 "리뷰 삭제 중 오류가 발생했습니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 삭제는 되돌릴 수 없으므로 명확한 확인 절차를 거쳐야 합니다.

#### 데이터 요구사항 및 흐름

* **입력**: 삭제 대상 리뷰 ID.
* **처리**: DB 업데이트/삭제 (reviews), 평균 별점/리뷰 수 재계산.
* **저장**: reviews 테이블 업데이트/삭제.

#### 보안 및 개인정보 고려사항

* 본인의 리뷰만 삭제 가능하도록 서버 측에서 권한을 확인해야 합니다 (NF‑SECU‑007).

---

### UC‑15: 고객 보유 적립/쿠폰 시간 확인

| 구분               | 내용                                               |
| ---------------- | ------------------------------------------------ |
| **액터**           | 고객                                               |
| **개요**           | 고객이 마이페이지에서 자신이 보유한 적립 시간 및 사용 가능한 쿠폰 시간을 확인합니다. |
| **사전 조건**        | 고객이 로그인된 상태이며, 마이페이지(P‑005)에 접근했습니다.             |
| **사후 조건 (성공 시)** | 고객은 자신의 보유 적립 시간 및 쿠폰 정보를 확인할 수 있습니다.            |

#### 주요 성공 시나리오

1. 고객이 마이페이지(P‑005)에 접근합니다 *(또는 '보유 시간 확인' 탭/메뉴 클릭)*.
2. 시스템은 현재 로그인한 고객의 ID를 기반으로 customers 테이블에서 `accumulated_time_minutes` 값을 조회합니다.
3. 시스템은 customer\_coupons 테이블에서 해당 고객의 사용하지 않고 만료되지 않은 쿠폰 목록(또는 총 시간)을 조회합니다.
4. 시스템은 조회된 적립 시간과 쿠폰 정보를 마이페이지 UI에 명확하게 구분하여 표시합니다 (예: "적립 시간: XX분", "사용 가능 쿠폰: Y개 (ZZ분, 유효기간: \~YYYY.MM.DD)").

#### 대체 흐름 및 예외 처리

* **2a/3a. 데이터 조회 실패**: 시스템은 "보유 시간 정보를 불러오는 데 실패했습니다." 메시지를 표시하거나 해당 영역을 비워둡니다.

#### 사용자 인터페이스 고려사항

* 적립 시간과 쿠폰 시간을 명확히 구분하고, 쿠폰의 경우 개수, 총 시간, 유효 기간 등 필요한 정보를 함께 보여주는 것이 좋습니다.

#### 데이터 요구사항 및 흐름

* **입력**: 로그인된 고객 ID.
* **처리**: DB 조회 (customers, customer\_coupons).
* **출력**: 적립 시간 잔액, 사용 가능 쿠폰 목록/총 시간.

#### 보안 및 개인정보 고려사항

* 본인의 정보만 조회 가능하도록 RLS 정책 등으로 제어해야 합니다.

---

### UC‑16: 운영자 예약 현황 조회 및 상세 확인

| 구분               | 내용                                                |
| ---------------- | ------------------------------------------------- |
| **액터**           | 운영자                                               |
| **개요**           | 운영자가 관리 페이지에서 전체 예약 목록을 확인하고 특정 예약의 상세 정보를 조회합니다. |
| **유스케이스**        | UC‑16은 F‑MGMT‑O‑003, F‑MGMT‑O‑004 기능 요구사항과 관련됩니다. |
| **사전 조건**        | 운영자가 로그인하여 예약 현황 페이지(P‑101)에 접근한 상태입니다.           |
| **사후 조건 (성공 시)** | 운영자는 예약 목록 및 선택한 예약의 상세 정보를 확인할 수 있습니다.           |

#### 주요 성공 시나리오

1. 운영자가 예약 현황 페이지(P‑101)에 접근합니다.
2. 시스템은 reservations 테이블에서 모든 예약 정보를 조회하여 목록(테이블) 형태로 표시합니다 (기본 정렬: 예약 시간순). 고객 정보(customers) 테이블과 조인하여 필요한 정보(고객명 등)를 함께 표시합니다.
3. *(선택)* 운영자는 필터(날짜, 상태 등)를 사용하여 원하는 예약만 조회합니다.
4. 운영자는 목록에서 상세 정보를 확인할 예약을 클릭합니다.
5. 시스템은 해당 예약의 상세 정보(고객 연락처, 요청사항, 차량번호, 결제 상태, 운영자 메모 등)를 모달 또는 별도 영역에 표시합니다. 예약 변경/취소 버튼도 함께 표시됩니다.

#### 대체 흐름 및 예외 처리

* **2a. 데이터 조회 실패**: 시스템은 "예약 목록을 불러오는 데 실패했습니다." 메시지를 표시합니다.
* **5a. 상세 정보 조회 실패**: 시스템은 "예약 상세 정보를 불러오는 데 실패했습니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 예약 목록 테이블은 가독성이 좋아야 하며, 상태별 시각적 구분이 유용합니다.
* 상세 정보는 명확하게 구분되어 표시되어야 합니다.

#### 데이터 요구사항 및 흐름

* **입력**: *(선택)* 필터 조건, 클릭한 예약 ID.
* **처리**: DB 조회 (reservations, customers 조인).
* **출력**: 예약 목록, 예약 상세 정보.

#### 보안 및 개인정보 고려사항

* 운영자 권한이 있는 사용자만 접근 가능해야 합니다.
* 고객 개인정보(연락처 등) 접근에 대한 로그 기록을 고려할 수 있습니다.

---

### UC‑17: 운영자 고객 예약 변경

| 구분               | 내용                                                                                                                         |
| ---------------- | -------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 운영자                                                                                                                        |
| **개요**           | 운영자가 관리 페이지에서 시간 제약 없이 고객의 예약을 변경합니다.                                                                                      |
| **유스케이스**        | UC‑17은 F‑MGMT‑O‑012 기능 요구사항과 관련됩니다.                                                                                        |
| **사전 조건**        | 운영자가 로그인하여 예약 상세 정보(P‑101 내)를 보고 있습니다.                                                                                     |
| **사후 조건 (성공 시)** | - 해당 예약 정보(reservations 테이블)가 수정되고 상태가 `modified`로 업데이트됩니다.<br>- 고객 및 운영자에게 예약 변경 알림톡이 발송됩니다.<br>- 운영자에게 변경 완료 메시지가 표시됩니다. |
| **비즈니스 규칙 및 제약** | 운영자는 시간 제약 없이 변경 가능하나, 변경하려는 시간이 다른 예약과 중복되어서는 안 됩니다.                                                                      |

#### 주요 성공 시나리오

1. 운영자가 예약 상세 정보 화면에서 '예약 변경' 버튼을 클릭합니다.
2. 시스템은 예약 변경 인터페이스(P‑008과 유사)를 표시합니다.
3. 운영자는 변경할 새 날짜와 시간을 선택합니다.
4. 시스템은 선택한 시간의 예약 가능 여부를 확인합니다.
5. (예약 가능 시) 운영자는 '변경 완료' 버튼을 클릭합니다.
6. 시스템은 백엔드에 변경 요청을 보냅니다.
7. 백엔드는 시간 슬롯 중복 여부를 재검증합니다.
8. (유효성 통과 시) 백엔드는 reservations 테이블 정보를 업데이트하고 상태를 `modified`로 변경합니다.
9. 백엔드는 성공 응답을 프론트엔드로 보냅니다.
10. 시스템은 운영자에게 "예약이 성공적으로 변경되었습니다." 메시지를 표시하고 예약 목록/상세 정보를 갱신합니다.
11. (비동기) 시스템은 고객과 운영자에게 예약 변경 알림톡(F‑NOTI‑009)을 발송합니다.

#### 대체 흐름 및 예외 처리

* **4a. 변경 시간 예약 불가**: 시스템은 "선택하신 시간은 이미 예약되어 변경할 수 없습니다." 메시지를 표시합니다.
* **8a. DB 업데이트 실패**: 시스템은 "예약 변경 중 오류가 발생했습니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 사용자 예약 변경 UI와 일관성을 유지하여 운영자의 학습 부담을 줄입니다.

#### 데이터 요구사항 및 흐름

* **입력**: 변경 대상 예약 ID, 새로운 시작/종료 시간.
* **처리**: 예약 가능 여부 확인, DB 업데이트, 알림 발송.
* **저장**: reservations 테이블 업데이트.

#### 보안 및 개인정보 고려사항

* 운영자 권한 확인이 필요합니다.
* 변경 작업에 대한 로그 기록을 고려할 수 있습니다.

---

### UC‑18: 운영자 고객 예약 취소 (환불 처리 포함)

| 구분               | 내용                                                                                                                                                             |
| ---------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 운영자                                                                                                                                                            |
| **개요**           | 운영자가 관리 페이지에서 시간 제약 없이 고객의 예약을 취소하고 필요한 경우 환불 처리합니다.                                                                                                           |
| **유스케이스**        | UC‑18은 F‑MGMT‑O‑012 기능 요구사항과 관련됩니다.                                                                                                                            |
| **사전 조건**        | 운영자가 로그인하여 예약 상세 정보(P‑101 내)를 보고 있습니다.                                                                                                                         |
| **사후 조건 (성공 시)** | - 해당 예약 정보(reservations 테이블)의 상태가 `cancelled`로 변경됩니다.<br>- *(결제된 예약의 경우)* PortOne을 통해 환불 처리됩니다.<br>- 고객 및 운영자에게 예약 취소 알림톡이 발송됩니다.<br>- 운영자에게 취소 완료 메시지가 표시됩니다. |
| **비즈니스 규칙 및 제약** | 운영자는 시간 제약 없이 취소 가능합니다. 결제된 예약의 경우 환불 처리가 필요합니다.                                                                                                               |

#### 주요 성공 시나리오

1. 운영자가 예약 상세 정보 화면에서 '예약 취소' 버튼을 클릭합니다.
2. 시스템은 "정말로 이 예약을 취소하시겠습니까? 결제된 예약의 경우 환불 처리됩니다." 와 같은 확인 팝업을 표시합니다.
3. 운영자는 '확인' 버튼을 클릭합니다.
4. 시스템은 백엔드(Edge Function 또는 API)에 취소 요청을 보냅니다.
5. 백엔드는 해당 예약의 결제 상태를 확인합니다.
6. *(결제된 예약의 경우)* 백엔드는 PortOne 환불 API를 호출하여 결제 금액 전액 환불을 시도합니다.
7. *(환불 성공 또는 미결제 예약의 경우)* 백엔드는 reservations 테이블의 해당 예약 상태를 `cancelled`로 업데이트합니다 (트랜잭션 처리).
8. 백엔드는 성공 응답을 프론트엔드로 보냅니다.
9. 시스템은 운영자에게 "예약이 취소되었습니다. (환불 처리 완료)" 메시지를 표시하고 예약 목록/상세 정보를 갱신합니다.
10. (비동기) 시스템은 고객과 운영자에게 예약 취소 알림톡(F‑NOTI‑008)을 발송합니다.

#### 대체 흐름 및 예외 처리

* **6a. PortOne 환불 실패**: 시스템은 "환불 처리 중 오류가 발생했습니다. PortOne 관리자 페이지에서 직접 확인해주세요." 메시지를 표시하고 예약 상태는 변경하지 않습니다.
* **7a. DB 업데이트 실패**: 시스템은 "예약 취소 처리 중 오류가 발생했습니다." 메시지를 표시합니다. *(환불 롤백 필요 여부 확인)*

#### 사용자 인터페이스 고려사항

* 취소 및 환불은 중요한 작업이므로 명확한 확인 절차를 거쳐야 합니다.

#### 데이터 요구사항 및 흐름

* **입력**: 취소 대상 예약 ID.
* **처리**: 결제 상태 확인, PortOne 환불 API 호출, DB 업데이트, 알림 발송.
* **저장**: reservations 테이블 업데이트.

#### 보안 및 개인정보 고려사항

* 운영자 권한 확인이 필요합니다.
* 취소/환불 작업에 대한 로그 기록을 고려할 수 있습니다.

---

### UC‑19: 운영자 고객 목록 및 정보 조회 (적립/쿠폰 시간 포함)

| 구분               | 내용                                                       |
| ---------------- | -------------------------------------------------------- |
| **액터**           | 운영자                                                      |
| **개요**           | 운영자가 관리 페이지에서 전체 고객 목록과 각 고객의 상세 정보(적립/쿠폰 시간 포함)를 조회합니다. |
| **유스케이스**        | UC‑19는 F‑MGMT‑O‑005, F‑TIME‑009 기능 요구사항과 관련됩니다.          |
| **사전 조건**        | 운영자가 로그인하여 고객 목록 페이지(P‑103)에 접근한 상태입니다.                  |
| **사후 조건 (성공 시)** | 운영자는 고객 목록 및 선택한 고객의 상세 정보(적립/쿠폰 시간 포함)를 확인할 수 있습니다.     |

#### 주요 성공 시나리오

1. 운영자가 고객 목록 페이지(P‑103)에 접근합니다.
2. 시스템은 customers 테이블에서 모든 활성 고객 정보를 조회합니다.
3. *(선택)* 시스템은 각 고객별로 customer\_coupons 테이블을 조회하여 사용 가능한 쿠폰 정보를 집계합니다.
4. 시스템은 조회된 고객 목록(이름, 연락처, 가입 방식, 적립 시간 잔액, 보유 쿠폰 요약)을 테이블 형태로 표시합니다.
5. *(선택)* 운영자는 검색 필터를 사용하여 특정 고객을 검색합니다.
6. 운영자는 목록에서 상세 정보를 확인할 고객을 클릭합니다.
7. 시스템은 해당 고객의 상세 정보(기본 정보, 누적 적립 시간, 보유/사용 쿠폰 상세 내역 등)를 모달 또는 별도 영역에 표시합니다. 쿠폰 부여 버튼도 함께 표시됩니다.

#### 대체 흐름 및 예외 처리

* **2a/3a. 데이터 조회 실패**: 시스템은 "고객 목록을 불러오는 데 실패했습니다." 메시지를 표시합니다.
* **7a. 상세 정보 조회 실패**: 시스템은 "고객 상세 정보를 불러오는 데 실패했습니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 고객 목록 테이블은 필요한 정보를 명확하게 보여주고, 검색/정렬/페이지네이션 기능을 제공하면 좋습니다 *(향후 확장)*.
* 고객 상세 정보는 가독성 있게 구성되어야 합니다.

#### 데이터 요구사항 및 흐름

* **입력**: *(선택)* 검색 조건, 클릭한 고객 ID.
* **처리**: DB 조회 (customers, customer\_coupons).
* **출력**: 고객 목록, 고객 상세 정보 (적립/쿠폰 포함).

#### 보안 및 개인정보 고려사항

* 운영자 권한 확인이 필요합니다.
* 고객 개인정보 접근에 대한 로그 기록을 고려할 수 있습니다.

---

### UC‑20: 운영자 리뷰 목록 조회 및 관리 (숨김/삭제)

| 구분               | 내용                                                                                                                                       |
| ---------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 운영자                                                                                                                                      |
| **개요**           | 운영자가 관리 페이지에서 등록된 리뷰 목록을 확인하고, 부적절한 리뷰를 숨기거나 삭제합니다.                                                                                      |
| **유스케이스**        | UC‑20은 F‑MGMT‑R‑011 기능 요구사항과 관련됩니다.                                                                                                      |
| **사전 조건**        | 운영자가 로그인하여 리뷰 관리 페이지(P‑107)에 접근한 상태입니다.                                                                                                  |
| **사후 조건 (성공 시)** | - *(숨김/해제)* 해당 리뷰의 `is_hidden` 상태가 변경됩니다.<br>- *(삭제)* 해당 리뷰가 삭제되거나 비활성화 처리됩니다 (`deleted_at` 업데이트).<br>- 운영자에게 처리 완료 메시지가 표시되고 목록이 갱신됩니다. |
| **비즈니스 규칙 및 제약** | 운영자는 모든 리뷰를 조회하고 관리할 수 있습니다.                                                                                                             |

#### 주요 성공 시나리오 (Main Steps and Flow of Events)

1. 운영자가 리뷰 관리 페이지(P‑107)에 접근합니다.
2. 시스템은 reviews 테이블에서 모든 리뷰(삭제 제외) 정보를 조회하여 목록(테이블) 형태로 표시합니다 *(작성자, 별점, 내용, 이미지, 작성일, 숨김 상태 등)*.
3. *(선택)* 운영자는 필터(예: 숨김 상태)를 사용하거나 검색합니다.
4. 운영자는 관리할 리뷰를 확인하고 '숨기기/보이기' 토글 버튼 또는 '삭제' 버튼을 클릭합니다.
5. *(숨김/해제 시)*
   a. 시스템은 해당 리뷰의 `is_hidden` 값을 반대로 업데이트합니다.
   b. 시스템은 운영자에게 "리뷰 상태가 변경되었습니다." 메시지를 표시하고 목록을 갱신합니다.
6. *(삭제 시)*
   a. 시스템은 "정말로 이 리뷰를 삭제하시겠습니까?" 확인 팝업을 표시합니다.
   b. 운영자는 '확인' 버튼을 클릭합니다.
   c. 시스템은 해당 리뷰의 `deleted_at` 타임스탬프를 업데이트하거나 레코드를 삭제합니다.
   d. *(고려)* 시스템은 서비스 평균 별점/리뷰 수를 재계산합니다.
   e. 시스템은 운영자에게 "리뷰가 삭제되었습니다." 메시지를 표시하고 목록을 갱신합니다.

#### 대체 흐름 및 예외 처리

* **2a. 데이터 조회 실패**: 시스템은 "리뷰 목록을 불러오는 데 실패했습니다." 메시지를 표시합니다.
* **5a/6c. DB 처리 실패**: 시스템은 "리뷰 처리 중 오류가 발생했습니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 리뷰 목록 테이블은 관리자가 내용을 쉽게 파악할 수 있도록 구성되어야 합니다.
* 숨김/삭제 액션은 명확한 버튼으로 제공하고, 삭제 시 확인 절차를 거칩니다.

#### 데이터 요구사항 및 흐름

* **입력**: *(선택)* 필터 조건, 클릭한 리뷰 ID 및 액션(숨김/해제/삭제).
* **처리**: DB 조회/업데이트/삭제 (reviews), 평균 별점/리뷰 수 재계산.
* **저장**: reviews 테이블 업데이트/삭제.

#### 보안 및 개인정보 고려사항

* 운영자 권한 확인이 필요합니다.
* 리뷰 관리 작업에 대한 로그 기록을 고려할 수 있습니다.

---

### UC‑21: 운영자 서비스 정보 관리

| 구분               | 내용                                                                                                                                  |
| ---------------- | ----------------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 운영자                                                                                                                                 |
| **개요**           | 운영자가 관리 페이지에서 서비스의 기본 정보(이름, 설명, 가격 등) 및 이미지를 수정합니다.                                                                                |
| **유스케이스**        | UC‑21은 F‑MGMT‑B 기능 요구사항 그룹과 관련됩니다.                                                                                                  |
| **사전 조건**        | 운영자가 로그인하여 서비스 정보 관리 페이지(P‑106)에 접근한 상태입니다.                                                                                         |
| **사후 조건 (성공 시)** | - services 테이블의 해당 서비스 정보가 수정됩니다.<br>- *(이미지 변경 시)* 새 이미지가 Supabase Storage에 업로드되고 이전 이미지는 삭제될 수 있습니다.<br>- 운영자에게 저장 완료 메시지가 표시됩니다. |
| **비즈니스 규칙 및 제약** | - 입력 필드의 유효성(예: 가격은 숫자)을 검증해야 합니다.<br>- 이미지 파일 형식/크기 제한을 준수해야 합니다.                                                                  |

#### 주요 성공 시나리오

1. 운영자가 서비스 정보 관리 페이지(P‑106)에 접근합니다.
2. 시스템은 현재 services 테이블의 정보를 조회하여 폼에 표시합니다.
3. 운영자는 수정할 정보(텍스트, 가격)를 입력하거나 새 대표 이미지를 업로드합니다.
4. 운영자는 '저장하기' 버튼을 클릭합니다.
5. 시스템은 입력값의 유효성을 검사하고, 이미지 파일의 형식/크기를 확인합니다.
6. *(유효성 통과 시)* 시스템은 백엔드에 수정 요청을 보냅니다.
7. *(이미지 변경 시)* 백엔드는 새 이미지를 Supabase Storage에 업로드하고 URL을 얻습니다 *(이전 이미지 삭제 로직 추가 가능)*.
8. 백엔드는 services 테이블의 해당 레코드를 수정된 정보(텍스트, 가격, 이미지 URL 등)로 업데이트합니다.
9. 백엔드는 성공 응답을 프론트엔드로 보냅니다.
10. 시스템은 운영자에게 "서비스 정보가 성공적으로 저장되었습니다." 메시지를 표시합니다.

#### 대체 흐름 및 예외 처리

* **5a. 유효성 검사 실패**: 시스템은 오류 내용을 표시하고 저장을 중단합니다.
* **7a. 이미지 업로드 실패**: 시스템은 "이미지 업로드 중 오류가 발생했습니다." 메시지를 표시합니다.
* **8a. DB 업데이트 실패**: 시스템은 "정보 저장 중 오류가 발생했습니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 현재 정보를 명확히 보여주고 수정하기 쉬운 폼 인터페이스를 제공합니다.
* 이미지 업로드 시 미리보기 기능을 제공합니다.

#### 데이터 요구사항 및 흐름

* **입력**: 수정된 서비스 정보(텍스트, 가격), 새 이미지 파일.
* **처리**: 유효성 검사, 이미지 업로드/삭제, DB 업데이트.
* **저장**: services 테이블 업데이트, Supabase Storage.

#### 보안 및 개인정보 고려사항

* 운영자 권한 확인이 필요합니다.
* 서비스 정보 변경에 대한 로그 기록을 고려할 수 있습니다.

---

### UC‑22: 운영자 예약 설정 관리 (휴무일 등)

| 구분               | 내용                                                                                                                 |
| ---------------- | ------------------------------------------------------------------------------------------------------------------ |
| **액터**           | 운영자                                                                                                                |
| **개요**           | 운영자가 관리 페이지에서 휴무일을 설정하여 예약 가능 여부를 제어합니다.                                                                           |
| **유스케이스**        | UC‑22는 F‑MGMT‑O‑001, F‑MGMT‑O‑002 기능 요구사항과 관련됩니다.                                                                  |
| **사전 조건**        | 운영자가 로그인하여 예약 설정 페이지(P‑102)에 접근한 상태입니다.                                                                            |
| **사후 조건 (성공 시)** | - 휴무일 정보가 holidays 테이블(또는 services 테이블)에 저장/삭제됩니다.<br>- 설정된 휴무일은 예약 가능 시간 조회 시 반영됩니다.<br>- 운영자에게 설정 완료 메시지가 표시됩니다. |
| **비즈니스 규칙 및 제약** | 휴무일 설정 방식(특정 날짜, 반복 요일)을 지원합니다.                                                                                    |

#### 주요 성공 시나리오

1. 운영자가 예약 설정 페이지(P‑102)에 접근합니다.
2. 시스템은 현재 설정된 휴무일 목록을 조회하여 표시합니다.
3. 운영자는 휴무일을 추가하기 위해 날짜 선택기 또는 요일 체크박스를 사용하고 '추가' 또는 '저장' 버튼을 클릭합니다.<br>  *(또는) 운영자는 기존 휴무일 항목 옆의 '삭제' 버튼을 클릭합니다.*
4. 시스템은 백엔드에 휴무일 추가/삭제 요청을 보냅니다.
5. 백엔드는 요청에 따라 holidays 테이블(또는 services 테이블)에 데이터를 추가하거나 삭제합니다.
6. 백엔드는 성공 응답을 프론트엔드로 보냅니다.
7. 시스템은 운영자에게 "휴무일 설정이 저장되었습니다." 또는 "휴무일이 삭제되었습니다." 메시지를 표시하고 목록을 갱신합니다.

#### 대체 흐름 및 예외 처리

* **6a. DB 처리 실패**: 시스템은 "휴무일 설정 중 오류가 발생했습니다." 메시지를 표시합니다.

#### 사용자 인터페이스 고려사항

* 캘린더 기반의 날짜 선택기, 요일 체크박스 등 직관적인 인터페이스를 제공합니다.
* 현재 설정된 휴무일 목록을 명확하게 보여줍니다.

#### 데이터 요구사항 및 흐름

* **입력**: 추가/삭제할 휴무일 정보 (날짜 또는 요일).
* **처리**: DB Insert/Delete (holidays 또는 services).
* **저장**: holidays 테이블 또는 services 테이블.

#### 보안 및 개인정보 고려사항

* 운영자 권한 확인이 필요합니다.

---

### UC‑23: 운영자 대리 예약 생성 및 결제 요청

| 구분               | 내용                                                                                                                                                  |
| ---------------- | --------------------------------------------------------------------------------------------------------------------------------------------------- |
| **액터**           | 운영자                                                                                                                                                 |
| **개요**           | 운영자가 고객을 대신하여 예약을 생성하고, 고객에게 결제를 요청하는 알림을 보냅니다.                                                                                                     |
| **유스케이스**        | UC‑23은 F‑MGMT‑O‑008 \~ F‑MGMT‑O‑011, F‑NOTI‑005 기능 요구사항과 관련됩니다.                                                                                     |
| **사전 조건**        | 운영자가 로그인하여 대리 예약 페이지(P‑105) 또는 예약 현황 페이지(P‑101)에 접근한 상태입니다.                                                                                         |
| **사후 조건 (성공 시)** | - 예약 정보가 reservations 테이블에 `pending_payment` 상태로 저장됩니다 *(운영자 메모 포함)*.<br>- 해당 고객에게 결제 요청 카카오 알림톡이 발송됩니다.<br>- 운영자에게 예약 생성 및 결제 요청 발송 완료 메시지가 표시됩니다. |
| **비즈니스 규칙 및 제약** | - 고객 정보(이름, 연락처)가 필요합니다.<br>- 시간 슬롯은 예약 가능해야 합니다.                                                                                                   |

#### 주요 성공 시나리오

1. 운영자가 대리 예약을 시작합니다 *(예: P‑101에서 버튼 클릭 또는 P‑105 직접 접근)*.
2. 운영자는 고객을 검색하여 선택하거나, 신규 고객 정보(이름, 연락처)를 입력합니다.
3. 운영자는 예약할 날짜와 시간을 선택합니다 *(P‑008과 유사 UI)*.
4. *(선택)* 운영자는 참고용 메모를 입력합니다.
5. 운영자는 '결제 요청 예약 생성' 버튼을 클릭합니다.
6. 시스템은 백엔드에 대리 예약 생성 요청을 보냅니다.
7. 백엔드는 시간 슬롯 중복 여부 등 유효성을 검증합니다.
8. *(유효성 통과 시)* 백엔드는 reservations 테이블에 예약 정보를 `pending_payment` 상태로 저장합니다 *(메모 포함)*.
9. 백엔드는 해당 고객에게 결제 요청 카카오 알림톡(F‑NOTI‑005)을 발송합니다 *(결제 페이지 링크 포함)*.
10. 백엔드는 성공 응답을 프론트엔드로 보냅니다.
11. 시스템은 운영자에게 "대리 예약이 생성되었고 고객에게 결제 요청 알림을 발송했습니다." 메시지를 표시합니다.

#### 대체 흐름 및 예외 처리

* **2a. 고객 정보 부족**: 시스템은 "고객 정보(이름, 연락처)를 입력하거나 선택해주세요." 메시지를 표시합니다.
* **7a. 시간 슬롯 예약 불가**: 시스템은 "선택하신 시간은 예약이 불가능합니다." 메시지를 표시합니다.
* **8a. DB 저장 실패**: 시스템은 "대리 예약 생성 중 오류가 발생했습니다." 메시지를 표시합니다.
* **9a. 알림톡 발송 실패**: 시스템은 예약은 생성하되, "알림톡 발송에 실패했습니다." 메시지를 표시하거나 내부 로그를 남깁니다.

#### 사용자 인터페이스 고려사항

* 고객 검색/선택 UI, 날짜/시간 선택 UI, 메모 입력 필드 등을 명확하게 제공합니다.

#### 데이터 요구사항 및 흐름

* **입력**: 고객 정보(ID 또는 신규 정보), 예약 날짜/시간, 운영자 메모.
* **처리**: 고객 정보 확인/저장, 시간 슬롯 유효성 검증, DB Insert (reservations), 알림 발송.
* **저장**: reservations 테이블.

#### 보안 및 개인정보 고려사항

* 운영자 권한 확인이 필요합니다.
* 고객 정보 처리 시 개인정보 보호 규정을 준수합니다.
* 결제 요청 링크는 안전하게 생성되어야 합니다.

---

*end of document*
